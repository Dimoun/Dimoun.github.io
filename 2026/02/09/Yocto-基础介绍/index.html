<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="参考： Yocto 官网：https:&#x2F;&#x2F;docs.yoctoproject.org&#x2F; Yocto Release: https:&#x2F;&#x2F;www.yoctoproject.org&#x2F;development&#x2F;releases&#x2F;#current 一、Yocto1. Yocto 基础信息1.1 Yocto 概述Yocto全称是Yocto Project（官方简称YP） 是Linux基金会在2010年推出的一个">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2026/02/09/Yocto-%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="参考： Yocto 官网：https:&#x2F;&#x2F;docs.yoctoproject.org&#x2F; Yocto Release: https:&#x2F;&#x2F;www.yoctoproject.org&#x2F;development&#x2F;releases&#x2F;#current 一、Yocto1. Yocto 基础信息1.1 Yocto 概述Yocto全称是Yocto Project（官方简称YP） 是Linux基金会在2010年推出的一个">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/images/yocto/image-OE_Yocto.png">
<meta property="og:image" content="http://example.com/images/yocto/image.png">
<meta property="og:image" content="http://example.com/images/yocto/image-1.png">
<meta property="og:image" content="http://example.com/images/yocto/image-2.png">
<meta property="og:image" content="http://example.com/images/yocto/image-build.png">
<meta property="og:image" content="http://example.com/images/yocto/image-3.png">
<meta property="og:image" content="http://example.com/images/yocto/image-6.png">
<meta property="og:image" content="http://example.com/images/yocto/image-8.png">
<meta property="og:image" content="http://example.com/images/yocto/image-9.png">
<meta property="og:image" content="http://example.com/images/yocto/image-7.png">
<meta property="og:image" content="http://example.com/images/yocto/image-10.png">
<meta property="og:image" content="http://example.com/images/yocto/image-12.png">
<meta property="og:image" content="http://example.com/images/yocto/image-13.png">
<meta property="og:image" content="http://example.com/images/yocto/image-15.png">
<meta property="og:image" content="http://example.com/images/yocto/image-16.png">
<meta property="og:image" content="http://example.com/images/yocto/image-17.png">
<meta property="og:image" content="http://example.com/images/yocto/image-18.png">
<meta property="og:image" content="http://example.com/images/yocto/image-19.png">
<meta property="article:published_time" content="2026-02-09T14:24:07.094Z">
<meta property="article:modified_time" content="2026-02-09T14:23:20.254Z">
<meta property="article:author" content="Dimm">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/yocto/image-OE_Yocto.png">

<link rel="canonical" href="http://example.com/2026/02/09/Yocto-%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title> | Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2026/02/09/Yocto-%E5%9F%BA%E7%A1%80%E4%BB%8B%E7%BB%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Dimm">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2026-02-09 22:24:07 / 修改时间：22:23:20" itemprop="dateCreated datePublished" datetime="2026-02-09T22:24:07+08:00">2026-02-09</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>参考：</p>
<p>Yocto 官网：<a target="_blank" rel="noopener" href="https://docs.yoctoproject.org/">https://docs.yoctoproject.org/</a></p>
<p>Yocto Release: <a target="_blank" rel="noopener" href="https://www.yoctoproject.org/development/releases/#current">https://www.yoctoproject.org/development/releases/#current</a></p>
<h1 id="一、Yocto"><a href="#一、Yocto" class="headerlink" title="一、Yocto"></a>一、Yocto</h1><h2 id="1-Yocto-基础信息"><a href="#1-Yocto-基础信息" class="headerlink" title="1. Yocto 基础信息"></a>1. Yocto 基础信息</h2><h3 id="1-1-Yocto-概述"><a href="#1-1-Yocto-概述" class="headerlink" title="1.1 Yocto 概述"></a>1.1 Yocto 概述</h3><p>Yocto全称是Yocto Project（官方简称YP） 是Linux基金会在2010年推出的一个开源的<strong>协作项目</strong>。提供模板、工具和方法以创建定制的Linux系统和配套工具，而无需关心<strong>硬件体系</strong>。主要由Poky和 其他一些工具组成。</p>
<p>从历史上看，<strong>Yocto Project是从OpenEmbedded项目</strong>发展而来的。他们本是两个不同的项目（左侧分离视图），然而，目前的<strong>OpenEmbedded与Yocto Project</strong>已经融合为一体了（右侧合并视图），因为目前已经很少见单独使用OpenEmbedded了。</p>
<p><img src="/images/yocto/image-OE_Yocto.png" alt="alt text"></p>
<h3 id="1-2-Yocto-组件"><a href="#1-2-Yocto-组件" class="headerlink" title="1.2 Yocto 组件"></a>1.2 Yocto 组件</h3><h4 id="1-2-1-Open-Embedded-Build-System-组件"><a href="#1-2-1-Open-Embedded-Build-System-组件" class="headerlink" title="1.2.1 Open-Embedded Build System 组件"></a>1.2.1 Open-Embedded Build System 组件</h4><ol>
<li><p>组件：</p>
<ul>
<li><p><strong>Metadata</strong>: 用于构建 Linux 发行版，并包含在 OpenEmbedded 构建系统在构建镜像<br>时解析的文件中</p>
<ul>
<li><strong>.bb（BitBake Recipe）文件</strong>：描述如何获取、配置、编译和安装一个软件包</li>
<li><strong>.bbappend 文件</strong>：用于扩展或修改已有的 .bb 文件</li>
<li><strong>.conf 配置文件</strong>：配置文件定义了控制 OpenEmbedded 构建过程的各种配置变量。这些文件分为几个部分，分别定义了<strong>机器配置选项、发行版配置选项、编译器调优选项、通用配置选项和用户配置选项</strong>， conf&#x2F;local.conf这些选项位于构建目录中。</li>
<li><strong>.bbclass 类文件</strong>：类文件用于抽象通用功能，并在多个配方（.bb）文件之间共享</li>
<li><strong>.inc 包含文件（Include File）</strong>：将通用配置和函数提取到单独的文件中，可以被多个recipe(.bb) 文件或其他 .inc 文件包含使用</li>
</ul>
</li>
<li><p><strong>BitBake</strong>： BitBake 是 Yocto 项目的核心组件，OpenEmbedded 构建系统使用它来构建镜像。虽然 BitBake 对构建系统至关重要，但它的维护独立于 Yocto 项目。</p>
<p>  BitBake 是一个通用的任务执行引擎，它允许在复杂的任务间依赖关系约束下高效并行地运行 shell 和 Python 任务。简而言之，BitBake 是一个<strong>构建引擎</strong>，它通过处理以特定格式编写的配方来执行一系列任务。</p>
</li>
<li><p><strong>OpenEmbedded-Core</strong>： OpenEmbedded-Core (OE-Core) 是一个通用的元数据层（例如配方、类和相关文件），供包括 Yocto 项目在内的 OpenEmbedded 衍生系统使用。Yocto 项目和 OpenEmbedded 项目共同维护 OpenEmbedded-Core。</p>
<p>  从历史上看，Yocto 项目一直将 OE-Core 元数据集成到 Yocto 项目源代码库参考系统 (Poky) 中。在 Yocto 项目 1.0 版本之后，Yocto 项目和 OpenEmbedded 达成合作协议，共同共享一套通用的核心元数据 (OE-Core)，其中包含了之前 Poky 中的许多功能。</p>
</li>
<li><p><strong>Layer (meta-xxx)</strong>: 层是包含相关元数据（即指令集）的存储库，这些元数据告诉 OpenEmbedded 构建系统如何构建目标。</p>
</li>
</ul>
</li>
</ol>
<h4 id="1-2-2-参考发行版-Poky"><a href="#1-2-2-参考发行版-Poky" class="headerlink" title="1.2.2 参考发行版 (Poky)"></a>1.2.2 参考发行版 (Poky)</h4><p><strong>Poky</strong>是一个参考嵌入式发行版和参考测试配置实例，其创建目的在于：</p>
<ul>
<li>提供一个基础功能发行版，可用于演示如何定制发行版；</li>
<li>测试 Yocto 项目组件，Poky 用于验证 Yocto 项目；</li>
<li>作为用户下载 Yocto 项目的途径。Poky 并非产品级发行版，而是定制的良好起点。</li>
</ul>
<p>文件夹说明：   </p>
<ul>
<li><strong>BitBake</strong> 是一个任务执行器和调度器，它是 OpenEmbedded 构建系统的核心。</li>
<li><strong>meta-poky</strong>这是 Poky 特有的元数据。</li>
<li><strong>meta-yocto-bsp</strong>它们是 Yocto 项目特定的板级支持包 (BSP)。</li>
<li><strong>OpenEmbedded-Core (OE-Core)</strong> 元数据包含共享配置、全局变量定义、共享类、打包方式和配方。类定义了构建逻辑的封装和继承。配方是待构建软件和镜像的逻辑单元。</li>
<li><strong>documentation</strong> 包含用于创建用户手册集的 Yocto 项目源文件。</li>
</ul>
<p><img src="/images/yocto/image.png" alt="alt text"></p>
<h2 id="2-OpenEmbedded-构建系统"><a href="#2-OpenEmbedded-构建系统" class="headerlink" title="2. OpenEmbedded 构建系统"></a>2. OpenEmbedded 构建系统</h2><p>   一般来说，构建过程的工作流程包含以下几个功能区域：</p>
<ul>
<li><strong>用户配置</strong>：可用于控制构建过程的元数据。</li>
<li><strong>元数据层</strong>：提供软件、机器和发行版元数据的各种层。</li>
<li><strong>源文件</strong>：上游版本、本地项目和 SCM。</li>
<li><strong>构建系统</strong>：BitBake控制下的进程 </li>
<li><strong>软件包源</strong>：包含输出软件包（RPM、DEB 或 IPK）的目录，这些软件包随后用于构建由构建系统生成的镜像或软件开发工具包 (SDK)。</li>
<li><strong>图像</strong>：工作流程生成的图像。</li>
<li><strong>应用程序开发 SDK</strong>：与镜像一起生成或单独使用 BitBake 生成的交叉开发工具。<br>   <img src="/images/yocto/image-1.png" alt="alt text"></li>
</ul>
<h3 id="2-1-用户配置"><a href="#2-1-用户配置" class="headerlink" title="2.1 用户配置"></a>2.1 用户配置</h3><p><img src="/images/yocto/image-2.png" alt="alt text"></p>
<p>配置环境：</p>
<p><img src="/images/yocto/image-build.png" alt="alt text"></p>
<p><strong>local.conf</strong>文件提供了定义构建环境的许多基本变量。以下列出其中一些：</p>
<ul>
<li><p><strong>目标机器选择</strong>：由MACHINE变量控制 。</p>
</li>
<li><p><strong>下载目录</strong>：由DL_DIR变量控制 。</p>
</li>
<li><p>共享状态目录：由SSTATE_DIR变量控制 。</p>
</li>
<li><p><strong>构建输出</strong>：由TMPDIR变量控制 。</p>
</li>
<li><p><strong>分发策略</strong>：由DISTRO变量控制 。</p>
</li>
<li><p>包装格式：由PACKAGE_CLASSES变量控制 。</p>
</li>
<li><p>SDK 目标架构：由SDKMACHINE变量控制 。</p>
</li>
<li><p>额外图像包：由EXTRA_IMAGE_FEATURES变量控制 。</p>
</li>
</ul>
<h3 id="2-2-构建层级"><a href="#2-2-构建层级" class="headerlink" title="2.2 构建层级"></a>2.2 构建层级</h3><p>构建层级分为软件、机器和发行层。</p>
<ul>
<li><p><strong>元数据（.bb 文件 + 补丁）</strong>：包含用户提供的配方文件、补丁和追加文件的软件层。OpenEmbedded Layer Index 中的meta-qt5 层就是一个很好的软件层示例。该层适用于流行的跨平台应用程序开发框架Qt的 5.0 版本，该框架支持桌面、嵌入式和移动应用开发。</p>
</li>
<li><p><strong>机器 BSP 配置</strong>：板级支持包 (BSP) 层提供特定于机器的配置信息。此类信息特定于特定的目标架构。参考 发行版 (Poky)中的<strong>meta-yocto-bsp</strong>层就是 一个典型的 BSP 层示例 。</p>
</li>
<li><p><strong>发行配置</strong>：发行层为特定分发版本构建的镜像或 SDK 提供顶级或通用策略。例如，在 Poky 参考分发版本中，分发层是<strong>meta-poky</strong>层。分发层中包含一个conf&#x2F;distro目录，其中包含分发配置文件（例如 poky.conf ，其中包含 Poky 分发版本的许多发行配置）。</p>
</li>
</ul>
<p><img src="/images/yocto/image-3.png" alt="alt text"></p>
<ul>
<li><p>BitBake 使用<strong>build_xxx&#x2F;conf&#x2F;bblayers.conf</strong>用户配置中的该文件来查找在构建过程中应该使用的层。</p>
</li>
<li><p>BitBake 根据<strong>xxxLayer&#x2F;conf&#x2F;layer.conf</strong> 去查找Layer下的.bb文件</p>
<p> local.conf 示例：</p>
<p> <img src="/images/yocto/image-6.png" alt="alt text"></p>
</li>
</ul>
<h4 id="2-2-1-发行层"><a href="#2-2-1-发行层" class="headerlink" title="2.2.1 发行层"></a>2.2.1 发行层</h4><p>分发层为您的分发提供策略配置</p>
<p>在分发层中找到哪些内容：</p>
<ul>
<li>类：类文件（.bbclass）包含可在发行版中各个配方之间共享的通用功能。当您的配方继承一个类时，它们将采用该类的设置和功能。</li>
<li>conf：此区域包含层（conf&#x2F;layer.conf）、<strong>发行版（conf&#x2F;distro&#x2F;distro.conf）</strong>和任何发行版范围的包含文件的配置文件。</li>
<li><strong>recipes-XXX</strong>：影响整个发行版通用功能的配方和追加文件。此区域可能包含用于添加特定于发行版的配置、初始化脚本、自定义镜像配方等的配方和追加文件。</li>
</ul>
<h4 id="2-2-2-BSP-层"><a href="#2-2-2-BSP-层" class="headerlink" title="2.2.2 BSP 层"></a>2.2.2 BSP 层</h4><p>BSP 层提供针对特定硬件的机器配置。</p>
<p>BSP 层的配置目录包含机器的配置文件（conf&#x2F;machine&#x2F;machine.conf）以及当然还有层的配置文件（conf&#x2F;layer.conf）。</p>
<h4 id="2-2-3-软件层"><a href="#2-2-3-软件层" class="headerlink" title="2.2.3 软件层"></a>2.2.3 软件层</h4><p>软件层提供构建过程中使用的其他软件包的元数据。该层不包含特定于发行版或机器的元数据，这些元数据位于它们各自的层中。</p>
<p>这一层包含项目所需的任何配方、追加文件和补丁。</p>
<h3 id="2-3-源文件"><a href="#2-3-源文件" class="headerlink" title="2.3 源文件"></a>2.3 源文件</h3><p>源文件分为：上游项目文件、本地项目和源代码管理</p>
<p>源文件视图：</p>
<p><img src="/images/yocto/image-8.png" alt="alt text"></p>
<ul>
<li><strong>上游项目发布</strong>：上游项目版本以归档文件（例如 tarball 或 zip 文件）的形式存在于任何地方</li>
<li><strong>本地项目</strong>： 本地项目是指用户提供的自定义软件片段</li>
<li><strong>源代码控制管理器</strong>：构建系统还可以通过 各种源代码控制管理器（例如 Git 或 Subversion）提供的 获取器来获取源文件</li>
<li><strong>源镜像</strong>： 镜像分为两种：预镜像和常规镜像。PREMIRRORS 和 MIRRORS变量分别指向这两种镜像。BitBake 会先检查预镜像，然后再向上游查找源文件。<ul>
<li>预镜像通常指向您组织本地的共享目录。</li>
<li>常规镜像站点可以是互联网上的任何站点，当主站点由于某种原因无法正常运行时，这些站点可用作源代码的备用位置。<br> <img src="/images/yocto/image-9.png" alt="alt text"></li>
</ul>
</li>
</ul>
<p>变量：</p>
<ul>
<li><p><strong>SRC_URI</strong>： 变量指向源文件，而无需考虑其实际位置。每个配方都必须有一个指向源文件的SRC_URI变量。</p>
</li>
<li><p><strong>DL_DIR（下载目录）</strong>：首次构建时，系统会从不同的上游项目下载许多不同的源代码压缩包。所有压缩包都存储在由DL_DIR定义的目录中，构建系统会首先在该目录中查找源代码压缩包。</p>
<p> <img src="/images/yocto/image-7.png" alt="alt text"></p>
</li>
</ul>
<h3 id="2-4-Package-Feeds"><a href="#2-4-Package-Feeds" class="headerlink" title="2.4 Package Feeds"></a>2.4 Package Feeds</h3><p>当 OpenEmbedded 构建系统生成镜像或 SDK 时，它会从 构建目录中的软件包源区域获取软件包。</p>
<p><img src="/images/yocto/image-10.png" alt="alt text"></p>
<p>构建系统用于临时存储软件包的目录由多个变量以及所使用的特定软件包管理器共同决定。</p>
<ul>
<li><strong>DEPLOY_DIR</strong>：定义在 tmp&#x2F;deploy构建目录中。</li>
<li><strong>DEPLOY_DIR_XXX</strong>: 根据所使用的包管理器，包类型子文件夹也会有所不同。如果打包的是 RPM、IPK 或 DEB 格式，并且创建了 tarball 文件，则 分别使用DEPLOY_DIR_RPM、 DEPLOY_DIR_IPK、 DEPLOY_DIR_DEB或 DEPLOY_DIR_TAR变量。</li>
<li><strong>PACKAGE_ARCH</strong>：定义特定于架构的子文件夹。例如，软件包可以适用于 i586 或 qemux86 架构。</li>
</ul>
<h3 id="2-5-BitBake-工具"><a href="#2-5-BitBake-工具" class="headerlink" title="2.5 BitBake 工具"></a>2.5 BitBake 工具</h3><h4 id="2-5-1-基本变量"><a href="#2-5-1-基本变量" class="headerlink" title="2.5.1 基本变量"></a>2.5.1 基本变量</h4><p>此章节仅介绍一些最基本的变量，开发者如果有不理解的变量，可以在 poky&#x2F;documentation&#x2F;ref-manual&#x2F;variables.rst 文档查找介绍。此外，这些变量通常在bitbake.conf文件存在定义。</p>
<ul>
<li><strong>MACHINE</strong>： 指定使用的硬件配置文件，通常在local.conf文件定义；</li>
<li><strong>DISTRO</strong>： 指定使用的发行版配置文件，通常在local.conf文件定义；</li>
<li><strong>PN</strong>： 软件包名，一般是根据文件名自动生成；除了一些交叉编译的包，如gcc-cross会在bb中重新定义；</li>
<li><strong>PV</strong>： 软件包版本；</li>
<li><strong>PR</strong>： 食谱的修订，默认为r0；当包管理器在已构建的镜像上动态安装包时，PR很重要；</li>
<li><strong>BPN</strong>： 软件包名，去除指定的前后缀(如-native、-cross等)；</li>
<li><strong>BP</strong>： ${BPN}-${PV};</li>
<li><strong>SRC_URI</strong>： 源码路径，可以为上游或者本地文件路径，上游源码需要使用校验值；</li>
<li><strong>LICENSE： 配方的源许可证列表，必须设置；如果设置为”CLOSED”则关闭</strong>；</li>
<li>LIC_FILES_CHKSUM： 配方源代码中许可证文本的校验和，与LICENSE变量配合使用；</li>
<li><strong>PACKAGE_ARCH</strong>： 生成包的体系结构；</li>
<li>TARGET_VENDOR： 指定目标供应商的名称，openEuler设置为”-openeuler”；</li>
<li><strong>TARGET_OS</strong>： 指定目标的操作系统；</li>
<li>MULTIMACH_TARGET_SYS： 生成包的目标系统类型的唯一标识，默认为${PACKAGE_ARCH}${TARGET_VENDOR}-${TARGET_OS}；</li>
<li>WORKDIR： 构建配方的工作目录的路径名，指向${TMPDIR}&#x2F;work&#x2F;${MULTIMACH_TARGET_SYS}&#x2F;${PN}&#x2F;${EXTENDPE}${PV}-${PR}，EXTENDPE变量通常不被设置；</li>
<li>**S： 构建过程中源代码位置，默认为${WORKDIR}&#x2F;${BPN}-${PV}**；</li>
<li><strong>B： 构建过程中生成对象所在的目录，默认与S相同；一些类会将B设置为${WORKDIR}&#x2F;build</strong>；</li>
<li><strong>D： 相当于 make install 后的目标目录，指向${WORKDIR}&#x2F;image</strong>；</li>
<li>PACKAGES： 表示配方创建的包列表；</li>
<li>FILES_xxx： 放置在包中的文件和目录列表；</li>
<li><strong>PKGD： 要打包的文件的目录，指向${WORKDIR}&#x2F;package</strong>；</li>
<li>PKGDEST： 将文件拆分为单独的包后，指向要打包的文件的父目录，该目录是PACKAGES中指定的每个包的目录，指向${WORKDIR}&#x2F;packages-split；</li>
<li>DEPENDS： 列出配方的构建时依赖关系，配方在构建时需要其它配方的内容（例如头文件和共享库）；</li>
<li>RDEPENDS： 列出程序包的运行时依赖项，这些依赖项是必须安装的其他程序包，以便程序包正常运行；</li>
<li>RECIPE_SYSROOT： 指向${WORKDIR}&#x2F;recipe-sysroot；</li>
<li>RECIPE_SYSROOT_NATIVE： 指向${WORKDIR}&#x2F;recipe-sysroot-native；</li>
<li>SYSROOT_DESTDIR： 指向${WORKDIR}&#x2F;sysroot-destdir；</li>
<li>SYSROOT_DIRS： 暂存到${SYSROOT_DESTDIR}的目录；</li>
<li>STAGING_DIR_HOST： 组件运行所在的系统上的sysroot路径，默认为${RECIPE_SYSROOT}。</li>
<li>STAGING_DIR_NATIVE： 构建主机上运行的组件使用的sysroot的路径，默认为${RECIPE_SYSROOT_NATIVE}；</li>
<li>STAGING_DIR_TARGET： 当构建在系统上执行的组件并为另一台机器生成代码（例如cross-canadian配方）时使用的sysroot路径；</li>
<li>STAGING_KERNEL_DIR： 包含构建树外模块所需的内核头文件的目录（内核源码目录）；</li>
<li>STAGING_KERNEL_BUILDDIR： 指向包含内核构建工件的目录。需要访问内核构建工件的配方构建软件可以在内核构建后在STAGING_KERNEL_BUILDDIR变量指定的目录中查找这些工件；</li>
<li><strong>PACKAGE_CLASSES： 指定构建系统在打包数据时使用的包管理器（例如RPM、DEB或IPK），在local.conf文件设置</strong>；</li>
<li>IMAGE_ROOTFS： 指定根文件系统在构建过程中的位置（ do_rootfs 任务期间）。此变量不可配置，不要更改它；</li>
<li>IMAGE_FEATURES： 指定要包含在镜像中的主要功能列表，这些功能大多数都映射到其他安装包；</li>
<li>EXTRA_IMAGE_FEATURES： IMAGE_FEATURES的一部分；</li>
<li>IMAGE_INSTALL： 指定要安装到镜像中的程序包；</li>
<li>PACKAGE_EXCLUDE： ：指定不应安装到image中的包；</li>
<li>PACKAGE_INSTALL： 要安装到镜像中的程序包的列表，不要更改它，通常使用IMAGE_INSTALL变量间接进行修改；</li>
<li>DEPLOY_DIR： 指向构建系统用于放置镜像、包、SDK和其他输出文件的常规区域，这些文件已准备好在构建系统之外使用。默认情况下，此目录位于指向${TMPDIR}&#x2F;deploy。</li>
<li>DEPLOY_DIR_IMAGE： 指向构建系统用来放置准备部署到目标计算机上的镜像和其他相关输出文件的区域。该目录是特定于机器的默认情况下，此目录指向${DEPLOY_DIR}&#x2F;images&#x2F;${MACHINE}&#x2F;；</li>
<li>DEPLOYDIR： 当继承deploy类时，DEPLOYDIR指向已部署文件的临时工作区，默认指向${WORKDIR}&#x2F;deploy-${PN}，此目录内容会被拷贝到${DEPLOY_DIR_IMAGE}；</li>
<li>CC： 用于运行C编译器的最小命令和参数；</li>
<li>CFLAGS： 指定要传递给C编译器的标志；</li>
<li>CXXFLAGS： 指定要传递给C++编译器的标志；</li>
<li>CPPFLAGS： 指定要传递给C预处理器（即同时传递给C编译器和C++编译器）的标志；</li>
<li>LDFLAGS： 指定要传递给链接器的标志；</li>
<li>OVERRIDES： 以冒号分隔的当前应用的覆盖列表。覆盖是一种BitBake机制，允许在解析结束时选择性地覆盖变量；</li>
<li>COMPATIBLE_MACHINE： 一种正则表达式，解析为一个或多个与配方兼容的目标机器。可以使用该变量来停止为配方不兼容的机器构建配方，停止这些构建对于内核特别有用。该变量还有助于提高解析速度，因为构建系统会跳过与当前机器不兼容的解析配方。</li>
</ul>
<h4 id="2-5-2-基本任务"><a href="#2-5-2-基本任务" class="headerlink" title="2.5.2 基本任务"></a>2.5.2 基本任务</h4><p>配方（.bb文件）使用任务来完成软件的配置、编译和打包等。本节提供了在OpenEmbedded（Yocto）构建系统中定义的部分任务的作用。</p>
<p>Yocto支持的主要任务如下：</p>
<p><img src="/images/yocto/image-12.png" alt="alt text"></p>
<p>每个包实际的任务执行顺序可以在工作目录查看，具体是 <strong>$WORKDIR&#x2F;temp&#x2F;log.task_order</strong> 文件。</p>
<ul>
<li><strong>do_build</strong>: 配方的默认任务，依赖于构建一个配方的所有其他正常构建任务。因为Yocto默认在 meta&#x2F;classes&#x2F;base.bbclass 中设置了 <strong>do_build[noexec] &#x3D; “1”</strong> ，因此此任务并不会真的执行，只是一个虚拟任务，用于串连起各个模块的任务流。构建时，temp目录下不会存在其执行执行脚本及执行日志文件。</li>
<li><strong>do_fetch&#x2F;do_unpack</strong>:<ul>
<li><strong>do_fetch</strong>: 获取源文件</li>
<li><strong>do_unpack</strong>: 将源文件解压到工作目录（${WORKDIR}）下<br> <img src="/images/yocto/image-13.png" alt="alt text"><br> 示例：<br> <img src="/images/yocto/image-15.png" alt="alt text"></li>
</ul>
</li>
<li><strong>do_patch</strong>: 在获取、解压源码后打入补丁到源码目录（${S}），根据SRC_URI变量中补丁文件写入的顺序打入补丁</li>
<li><strong>do_prepare_recipe_sysroot</strong>: 为当前配方（recipe）准备构建环境所需的 sysroot，主要包含构建时依赖（DEPENDS 和 BUILDDEPENDS）的文件<ul>
<li>从构建时依赖（如交叉编译工具链、库的头文件和 .so 文件）中提取必要文件到 recipe-sysroot 目录</li>
<li>创建两个主要目录：<ul>
<li>recipe-sysroot：包含目标架构的依赖库和头文件（用于链接）</li>
<li>recipe-sysroot-native：包含本机架构的工具（用于构建过程）</li>
</ul>
</li>
<li>处理所有 DEPENDS 中指定的依赖项，将它们的内容复制到当前配方的 sysroot 中</li>
</ul>
</li>
<li><strong>do_configure</strong>: 通过启用和禁用正在构建软件的任何构建时和配置选项来配置源码</li>
<li><strong>do_compile</strong>: 编译源代码</li>
<li><strong>do_install</strong>: 复制要打包文件到保留区（${D}）<br> <img src="/images/yocto/image-16.png" alt="alt text"></li>
<li><strong>do_populate_sysroot</strong>: 将当前配方的构建输出安装到全局 sysroot 中，供其他配方作为依赖使用<ul>
<li>将当前配方的以下内容复制到全局 sysroot：<ul>
<li>头文件（include 目录）</li>
<li>库文件（lib 目录）</li>
<li>编译生成的 .pc 文件（pkg-config）</li>
<li>其他其他配方可能需要的内容</li>
</ul>
</li>
<li>创建符号链接和必要的元数据</li>
<li>为依赖此配方的其他配方提供构建时所需的文件</li>
</ul>
</li>
<li>**do_package:**： 根据PACKAGES和FILES_xxx变量，分析在${D}目录中找到的文件，并根据可用的包和文件将它们拆分为子集。</li>
<li><strong>do_packagedata</strong>: 将 do_package 任务生成的包元数据保存在PKGDATA_DIR目录中，以使其全局可用，以便构建系统可以生成最终包。</li>
</ul>
<p>分析和包拆分过程的工作、阶段和中间结果使用以下几个方面：</p>
<p>   <img src="/images/yocto/image-17.png" alt="alt text"></p>
<ul>
<li><strong>do_package_write_XXX:</strong><ul>
<li>do_package_write_rpm：创建 RPM 包（即*.rpm文件）</li>
<li>do_package_write_deb：创建 Debian 包（即*.deb文件）</li>
<li>do_package_write_ipk：创建 IPK 包（即*.ipk文件）</li>
<li>do_package_write_tar：创建 tar.gz 包</li>
</ul>
</li>
<li><strong>do_package_qa</strong>： 对打包文件运行QA检查。在构建配方时，OpenEmbedded构建系统会对输出执行各种QA检查，以确保检测和报告常见问题</li>
<li><strong>do_deploy</strong>： 将要部署的输出文件写入${DEPLOY_DIR_IMAGE}</li>
<li><strong>do_rootfs</strong>： 为镜像创建根文件系统（文件和目录结构）</li>
<li><strong>do_image</strong>：启动镜像生成过程，此任务通过 IMAGE_PREPROCESS_COMMAND 对image进行预处理，并通过动态生成的 do_image_xxx （镜像格式决定）任务构建图像<br><img src="/images/yocto/image-18.png" alt="alt text"></li>
<li><strong>do_image_complete</strong>：完成图像生成过程，此任务通过POSTPROCESS_COMMAND对图像执行后处理。</li>
</ul>
<h4 id="2-5-3-BitBake-任务映射："><a href="#2-5-3-BitBake-任务映射：" class="headerlink" title="2.5.3 BitBake 任务映射："></a>2.5.3 BitBake 任务映射：</h4><p><img src="/images/yocto/image-19.png" alt="alt text"></p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2025/07/29/hello-world/" rel="prev" title="Hello World">
      <i class="fa fa-chevron-left"></i> Hello World
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81Yocto"><span class="nav-number">1.</span> <span class="nav-text">一、Yocto</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Yocto-%E5%9F%BA%E7%A1%80%E4%BF%A1%E6%81%AF"><span class="nav-number">1.1.</span> <span class="nav-text">1. Yocto 基础信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-Yocto-%E6%A6%82%E8%BF%B0"><span class="nav-number">1.1.1.</span> <span class="nav-text">1.1 Yocto 概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-Yocto-%E7%BB%84%E4%BB%B6"><span class="nav-number">1.1.2.</span> <span class="nav-text">1.2 Yocto 组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-1-Open-Embedded-Build-System-%E7%BB%84%E4%BB%B6"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">1.2.1 Open-Embedded Build System 组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-2-%E5%8F%82%E8%80%83%E5%8F%91%E8%A1%8C%E7%89%88-Poky"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">1.2.2 参考发行版 (Poky)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-OpenEmbedded-%E6%9E%84%E5%BB%BA%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.2.</span> <span class="nav-text">2. OpenEmbedded 构建系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E7%94%A8%E6%88%B7%E9%85%8D%E7%BD%AE"><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1 用户配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E6%9E%84%E5%BB%BA%E5%B1%82%E7%BA%A7"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 构建层级</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-1-%E5%8F%91%E8%A1%8C%E5%B1%82"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">2.2.1 发行层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-2-BSP-%E5%B1%82"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">2.2.2 BSP 层</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-3-%E8%BD%AF%E4%BB%B6%E5%B1%82"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">2.2.3 软件层</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E6%BA%90%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.3.</span> <span class="nav-text">2.3 源文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Package-Feeds"><span class="nav-number">1.2.4.</span> <span class="nav-text">2.4 Package Feeds</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-BitBake-%E5%B7%A5%E5%85%B7"><span class="nav-number">1.2.5.</span> <span class="nav-text">2.5 BitBake 工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-1-%E5%9F%BA%E6%9C%AC%E5%8F%98%E9%87%8F"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">2.5.1 基本变量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-2-%E5%9F%BA%E6%9C%AC%E4%BB%BB%E5%8A%A1"><span class="nav-number">1.2.5.2.</span> <span class="nav-text">2.5.2 基本任务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-3-BitBake-%E4%BB%BB%E5%8A%A1%E6%98%A0%E5%B0%84%EF%BC%9A"><span class="nav-number">1.2.5.3.</span> <span class="nav-text">2.5.3 BitBake 任务映射：</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Dimm</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2026</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dimm</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
